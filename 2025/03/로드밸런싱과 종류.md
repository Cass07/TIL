#### 로드 밸런싱?
- 네트워크 기술 중 하나로, 서버에 들어온 요청을 2개 이상의 컴퓨터 자원에게 작업을 분배해 주는 기술
- 서버의 부하를 분산시켜 밸런스를 맞춰주는 기술이다
- 사용하는 이유
  - 서버의 부하가 늘어나면 서버 자체의 성능을 올리는 Scale-up으로는 한계가 있고 비용도 기하급수적으로 늘어나기 때문
  - 그래서 수평적으로 서버의 개수를 늘리는 scale-out을 사용하는데, 이를 위해서는 여러 서버에 부하를 잘 분산시켜 주는 것이 중요

#### 종류
- OSI 7계층 중에서 어디 레이어에서 처리하냐에 따라 다름

- L2
  - MAC 주소를 기반으로 하는 로드 밸런싱
  - L2 스위치에서 처리
  - IP 주소가 아닌 MAC 주소를 기반으로 하므로, IP 주소가 바뀌어도 문제 없음
- L3
  - IP 주소를 기반으로 하는 로드 밸런싱
  - L3 스위치에서 처리

- L4 (NLB)
  - 전송 레이어에서 분산처리
  - TCP/UDP 요청을 기반으로 하는 로드 밸런싱
  - 로드 밸런서도 정적 IP주소를 가짐

- L7 (ALB)
  - 애플리케이션 레이어에서 분산처리
    - 애플리케이션 레이어에서 동작하므로 HTTP2, WebSocket, SSL 등을 지원
  - Http/Https 요청을 기반으로 하는 로드 밸런싱
    - 사용자의 요청 정보를 기반으로 처리하기 때문에, 호스트 기반/URL 기반으로 분산처리 가능
  - 패킷 내용을 복호화해서 읽고 처리하기 때문에, L4에 비해서 속도가 느리고 부하가 많이 발생

#### 기타 기술
- NAT (Network Address Translation)
  - Private IP를 Public IP로 변환해 주는 역할을 한다
  - 패킷이 로드밸런서를 통과할 때 패킷의 IP 주소와 Port 정보를 변환

- DSR (Direct Server Return)
  - 로드밸런서가 패킷을 수신하고, 서버에 전달한 후, 응답을 보낼 때 클라이언트의 IP로 바로 보내는 방식
  - 로드밸런서의 부하를 줄일 수 있지만, NAT를 사용하지 않기 때문에 보안상 취약할 수 있다


#### 로드 밸런싱 알고리즘
- 라운드 로빈 : 들어온 요청을 순서대로 돌아가면서 분배
- 가중 라운드 로빈 : 서버마다 가중치를 매겨서, 가중치가 높은 서버일수록 우선적으로 요청을 분배
- Least Connection : 현재 연결된 클라이언트 수가 가장 적은 서버에 요청을 분배
- Weighted Least Connection : Least Connection에 가중치를 추가
- Fastest Response : 응답 속도가 가장 빠른 서버에 요청을 분배
- Source IP Hash : 클라이언트의 IP 주소를 해시값으로 변환해서 요청을 분배
  - 동일한 IP의 사용자는 항상 동일한 서버에 접속함을 보장